<div>
  <h1><%= @card_set.title %></h1>
</div>
<div>
  <% @card_set.flashcards.shuffle.each do |flashcard| %>
    <% @answers = [flashcard.correct_answer, flashcard.answer_1, flashcard.answer_2, flashcard.answer_3] %>
    <% @answers.shuffle! %>

    <div>
      <%= render "question_form", options: @answers, flashcard: flashcard, user_set: @user_set %>
    </div>

  <% end %>

</div>

<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script type="text/javascript">

$(document).on('submit', '.flash-form', function() {
  if($(this).parent().parent().siblings().length < 1) {
    let redirect = window.location.protocol + "//" + window.location.host + "/results"
    // timeout to prevent from the result page getting rendered before last answer is processed
    setTimeout (function () {
      window.location.replace(redirect)
    }, 200);
  }
  else {
    $(this).parent().parent().remove();
  }
});
</script>
